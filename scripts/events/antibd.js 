module.exports.config = {
  name: "antibd",
  eventType: ["log:user-nickname"],
  version: "1.0.0",
  author: "ğ™‹ğ™§ğ™ğ™®ğ™–ğ™£ğ™¨ğ™ ğ™ğ™–ğ™Ÿğ™¥ğ™ªğ™© + Raj Edit",
  description: "Against changing Bot's nickname"
};

module.exports.handleEvent = async function ({ api, event, Users, Threads }) {
  const { logMessageData, threadID, author } = event;
  const botID = api.getCurrentUserID();
  const { BOTNAME, ADMINBOT } = global.config;

  // Agar bot ka nickname change hua aur change karne wala bot khud nahi hai
  if (logMessageData.participant_id === botID && author !== botID) {
    // Agar change karne wala admin list me nahi hai
    if (!ADMINBOT.includes(author)) {
      // Thread data se bot ka stored nickname lo
      const threadData = await Threads.getData(threadID);
      const savedNickname =
        threadData?.data?.botNickname || BOTNAME || "Bot";

      // Agar naya nickname saved se alag hai to revert karo
      if (logMessageData.nickname !== savedNickname) {
        await api.changeNickname(savedNickname, threadID, botID);

        // Change karne wale ka naam lao
        const userInfo = await Users.getData(author);
        const name = userInfo?.name || "User";

        // Warning bhejo
        return api.sendMessage(
          `${name} - ğ™ğ™ğ™ˆ ğ˜½ğ™Šğ™ ğ™†ğ˜¼ ğ™‰ğ™„ğ˜¾ğ™†ğ™‰ğ˜¼ğ™ˆğ™€ ğ˜¾ğ™ƒğ˜¼ğ™‰ğ™‚ğ™€ ğ™‰ğ™„ ğ™†ğ˜¼ğ™ ğ™ğ˜¼ğ™†ğ™ğ˜¼ğ™” ğŸ˜¹ğŸ–`,
          threadID
        );
      }
    }
  }
};